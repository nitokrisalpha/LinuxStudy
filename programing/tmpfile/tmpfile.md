# 临时文件

* 很多情况下，程序会利用一些文件形式的临时存储手段。这些临时文件可能保存着一个计算的中间结果，也可能是关键操作前的文件备份

* 临时文件的用法很多，但是它有一个隐藏的缺点。你必须确保这个文件名是唯一的，由于linux是一个多任务系统，如果两个程序的文件名相同就可能会产生干扰。Linux给我们提供了 tmpname函数来生成一个唯一的文件名。如下

```c
    #include <stdio.h>
    char *tmpname(char *s);
```

* tmpname函数返回一个不与任何已存在文件同名的有效文件名。如果字符串S不为空，文件名也会写入它。对tmpname的后续调用会覆盖存放返回值的静态存储区，所以如果tmpname函数要被多次调用，就有必要给它传递一个字符串参数。这个字符串的长度至少要有L_tmpnam个字符。如果急需临时文件，可以用 tmpfile函数给它命名的同事打开它，如下

```c
    #include <stdio.h>
    FILE *tmpfile(void);
```

* 这个函数可以规避另一个与tmpname返回的文件名同名的文件，tmpfile函数返回的文件流指针指向的文件是以读写方式打开(通过w+方式fopen),当对它所有引用全部关闭时，该文件会自动删除

* 实验：源码见 tmpfile.c

* 解析：这个程序调用tmpnam为临时文件生成一个唯一的文件名，如果要使用它，必须极可能快的打开它以减小另一个程序用同样的名字打开文件的风险
